<template>
    <div >
        <div v-bind:class="['page-account', allVideoLoad ? 'complete' : '']" v-if="!getLoad" >
            <div class="page-account__title">
                <div class="page-account__title-box">
                    <a class="beck" @click="$router.go(-1);" v-if="getUser && getUser.id != account.id">
                        <svg width="12" height="19" viewBox="0 0 12 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M11.1708 2.03017L3.18474 9.5L11.1708 16.9698L11.366 17.1524L11.1708 17.335L10.2646 18.1826L10.0939 18.3423L9.92312 18.1826L0.829288 9.68264L0.633266 9.49942L0.829867 9.31682L1.74182 8.46983L1.74246 8.46922L9.92305 0.817421L10.0938 0.657683L10.2646 0.817421L11.1708 1.66502L11.366 1.8476L11.1708 2.03017Z"
                                fill="#2F80ED" stroke="#2F80ED" stroke-width="0.5"/>
                        </svg>
                        Назад
                    </a>
                    <div class="name">
                        <span class="userName">{{ '@' + account.username }}</span>
                        <span v-bind:class="['online', lastTimeOnline === 'online' ? 'active' : '']">{{lastTimeOnline}}</span>
                    </div>
                    <span class="acMenu" v-if="getUser && getUser.id == account.id" @click="switchOnClass('popupsMenu')">
                        <svg width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="17" height="2" rx="1" fill="#469BFC"/>
                            <rect y="5" width="17" height="2" rx="1" fill="#469BFC"/>
                            <rect y="10" width="17" height="2" rx="1" fill="#469BFC"/>
                        </svg>
                    </span>
                    <div class="btn" v-if="!getUser || getUser.id != account.id" @click="switchOnClass('popupsAccountMenu')">
                        <svg width="4" height="16" viewBox="0 0 4 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="4" height="4" rx="2" fill="#1D1D1F"/>
                            <rect y="6" width="4" height="4" rx="2" fill="#1D1D1F"/>
                            <rect y="12" width="4" height="4" rx="2" fill="#1D1D1F"/>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="page-account__poster">
                <img ref="poster" :src="account.cover" :class="{load: account.cover}" alt="">
            </div>

            <div class="page-account__content" ref="listBox" >
                <div class="page-account__avatar">
                    <div class="garland">
                        <svg width="55" height="11" viewBox="0 0 55 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 1C19.5634 9 36.4366 9 53 1" stroke="#555E69" stroke-width="0.75" stroke-miterlimit="10" stroke-linecap="round"/>
                            <rect x="4" y="4" width="3" height="3" rx="1.5" fill="#78D2FF"/>
                            <rect x="8" y="5" width="3" height="3" rx="1.5" fill="#4BB34B"/>
                            <rect x="12" y="6" width="3" height="3" rx="1.5" fill="#FFD54F"/>
                            <rect x="16" y="7" width="3" height="3" rx="1.5" fill="#FF4F72"/>
                            <rect x="20" y="8" width="3" height="3" rx="1.5" fill="#4BB34B"/>
                            <rect x="24" y="8" width="3" height="3" rx="1.5" fill="#FF4F72"/>
                            <rect x="28" y="8" width="3" height="3" rx="1.5" fill="#FFD54F"/>
                            <rect x="32" y="8" width="3" height="3" rx="1.5" fill="#78D2FF"/>
                            <rect x="36" y="7" width="3" height="3" rx="1.5" fill="#4BB34B"/>
                            <rect x="40" y="6" width="3" height="3" rx="1.5" fill="#FF4F72"/>
                            <rect x="44" y="5" width="3" height="3" rx="1.5" fill="#FFD54F"/>
                            <rect x="48" y="4" width="3" height="3" rx="1.5" fill="#FF4F72"/>
                            <rect x="52" y="3" width="3" height="3" rx="1.5" fill="#78D2FF"/>
                            <rect y="2" width="3" height="3" rx="1.5" fill="#FF4F72"/>
                        </svg>
                    </div>
                    <img ref="avatar" :class="{'noLoad':account.avatar == '/avatar.jpg'}" :src="account.avatar" style="opacity: 1;" alt="" v-if="account.avatar && account.avatar != '/avatar.jpg'">
                    <div v-else class="avatar-none" :class="'bgColor-'+ account.id % 7" >
                        {{getFirstLetter}}
                    </div>
                    <svg v-if="lastTimeOnline === 'online'" class="onlineStatus" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="0.5" y="0.5" width="19" height="19" rx="9.5" fill="#11D900" stroke="white"/>
                    </svg>
                    <svg v-if="account.verity" class="verity" width="18" height="16" viewBox="0 0 18 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M8.76736 0.280273L11.0784 2.90468L14.7459 2.54056L14.3469 5.88786L17.2222 7.99724L14.3469 10.1066L14.7459 13.454L11.0784 13.0898L8.76736 15.7142L6.45629 13.0898L2.78883 13.454L3.18786 10.1066L0.3125 7.99724L3.18786 5.88786L2.78883 2.54056L6.45629 2.90468L8.76736 0.280273Z"
                            fill="#469BFC"/>
                        <g clip-path="url(#clipss0)">
                            <path
                                d="M5.16602 8.87174L7.84686 12.0894L12.9946 5.92876L12.2555 5.05566L7.84686 10.3309L5.89482 7.99249L5.16602 8.87174Z"
                                fill="white"/>
                        </g>
                        <path
                            d="M8.768 16C8.6732 16 8.58332 15.9606 8.52398 15.8931L6.3204 13.3908L2.82353 13.738C2.73029 13.7472 2.63549 13.7174 2.56816 13.656C2.50123 13.5949 2.46788 13.5091 2.47829 13.4229L2.85868 10.2312L0.117115 8.21994C0.0431353 8.16578 0 8.08375 0 7.99722C0 7.91069 0.0431353 7.82866 0.117115 7.7745L2.85868 5.76323L2.47829 2.57155C2.46788 2.48531 2.50123 2.39964 2.56816 2.33847C2.6351 2.27709 2.7299 2.24723 2.82353 2.25644L6.3204 2.60364L8.52398 0.101339C8.64266 -0.0337796 8.89341 -0.0337796 9.01202 0.101339L11.2156 2.60364L14.7125 2.25644C14.8066 2.24751 14.9008 2.27738 14.9678 2.33847C15.0348 2.39957 15.0681 2.48531 15.0577 2.57155L14.6773 5.76323L17.4189 7.7745C17.4929 7.82866 17.536 7.91069 17.536 7.99722C17.536 8.08375 17.4929 8.16578 17.4189 8.21994L14.6773 10.2312L15.0577 13.4229C15.0681 13.5091 15.0348 13.5948 14.9678 13.656C14.9009 13.7174 14.8064 13.7467 14.7125 13.738L11.2156 13.3908L9.01202 15.8931C8.95268 15.9606 8.8628 16 8.768 16ZM6.45701 12.8039C6.55118 12.8039 6.64137 12.8427 6.70102 12.9108L8.768 15.2578L10.8349 12.9107C10.9016 12.8345 11.007 12.7946 11.1129 12.8055L14.3929 13.1312L14.036 10.1375C14.0244 10.0404 14.0678 9.9449 14.1513 9.88373L16.7228 7.99722L14.1513 6.11071C14.0679 6.04962 14.0244 5.95416 14.036 5.85698L14.3929 2.86323L11.1129 3.18898C11.0083 3.20013 10.9019 3.16026 10.8349 3.08373L8.768 0.736631L6.7011 3.08373C6.63417 3.1599 6.5277 3.19899 6.42311 3.18898L3.14309 2.86323L3.5 5.85698C3.51158 5.95409 3.46821 6.04955 3.38468 6.11071L0.813154 7.99722L3.38468 9.88373C3.46814 9.94483 3.51158 10.0403 3.5 10.1375L3.14309 13.1312L6.42311 12.8055C6.43438 12.8045 6.44573 12.8039 6.45701 12.8039Z"
                            fill="#469BFC"/>
                        <defs>
                            <clipPath id="clipss0">
                                <rect width="7.82857" height="9.37825" fill="white" transform="translate(5.16602 3.8833)"/>
                            </clipPath>
                        </defs>
                    </svg>
                </div>
                <div class="page-account__nik">
                    {{ account.name }}
                </div>
                <div class="page-account__info">
                    <span>{{ videosCount > 0 ? videosCount:0 }} Публикаций</span>
                    <svg width="3" height="3" viewBox="0 0 3 3" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="3" height="3" rx="1.5" fill="#BDBDBD"/>
                    </svg>
                    <span v-if="!account.hide_fols">{{ account.followers_count > 0 ? account.followers_count : 0 }} Друзей</span>
                </div>
                <div class="page-account__price" v-if="account.about !== '' && account.about != 'null'">
                    {{ account.about }}
                </div>
                <div v-if="getUser">
                    <div class="page-account__buttonSetting"  v-if="getUser.id == account.id">
                        <a @click="$router.push({name: 'settings'})" class="page-account__btnSettings">
                            <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.2244 6.41585L14.9474 6.13823C14.8364 5.79825 14.6988 5.46663 14.5364 5.14718L15.2434 4.04749C15.3697 3.851 15.3419 3.59304 15.1769 3.42799L13.1874 1.43853C13.0223 1.27348 12.7644 1.24572 12.5679 1.37198L11.4682 2.07895C11.1488 1.91657 10.8171 1.77902 10.4772 1.66798L10.1995 0.390944C10.15 0.162767 9.94791 0 9.71441 0H6.90098C6.66748 0 6.46541 0.162767 6.41585 0.390944L6.13823 1.66798C5.79825 1.77902 5.46663 1.91657 5.14718 2.07895L4.04749 1.37198C3.851 1.24572 3.59304 1.27348 3.42799 1.43853L1.43853 3.42799C1.27348 3.59304 1.24572 3.851 1.37198 4.04749L2.07895 5.14718C1.91657 5.46663 1.77902 5.79825 1.66798 6.13823L0.390944 6.41585C0.162767 6.46554 0 6.66748 0 6.90098V9.71441C0 9.94791 0.162767 10.1498 0.390944 10.1995L1.66798 10.4772C1.77902 10.8171 1.91657 11.1488 2.07895 11.4682L1.37198 12.5679C1.24572 12.7644 1.27348 13.0223 1.43853 13.1874L3.42799 15.1769C3.59304 15.3419 3.851 15.3697 4.04749 15.2434L5.14718 14.5364C5.46663 14.6988 5.79825 14.8364 6.13823 14.9474L6.41585 16.2244C6.46541 16.4526 6.66748 16.6154 6.90098 16.6154H9.71441C9.94791 16.6154 10.15 16.4526 10.1995 16.2244L10.4772 14.9474C10.8171 14.8364 11.1488 14.6988 11.4682 14.5364L12.5679 15.2434C12.7644 15.3697 13.0223 15.342 13.1874 15.1769L15.1769 13.1874C15.3419 13.0223 15.3697 12.7644 15.2434 12.5679L14.5364 11.4682C14.6988 11.1488 14.8364 10.8171 14.9474 10.4772L16.2244 10.1995C16.4526 10.1498 16.6154 9.94791 16.6154 9.71441V6.90098C16.6154 6.66748 16.4526 6.46554 16.2244 6.41585ZM11.2866 8.30769C11.2866 9.95019 9.95019 11.2866 8.30769 11.2866C6.66519 11.2866 5.32883 9.95019 5.32883 8.30769C5.32883 6.66519 6.66519 5.32883 8.30769 5.32883C9.95019 5.32883 11.2866 6.66519 11.2866 8.30769Z" fill="#469BFC"/>
                            </svg>
                            Изменить профиль
                        </a>
                        <div class="share" v-if="canShare"  @click="share(account.name,'',account.username)">
                            <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.4261 6.80198L10.4244 0.223419C10.2286 0.00909441 9.92851 -0.0581831 9.6673 0.0528159C9.40507 0.164886 9.2333 0.432925 9.2333 0.731123V3.8987H9.00252C4.03869 3.8987 0 8.16163 0 13.4011V14.863C0 15.202 0.226213 15.4847 0.539157 15.5618C0.590047 15.5754 0.640767 15.5813 0.691487 15.5813C0.952866 15.5813 1.20309 15.4194 1.32397 15.1651C2.62224 12.4235 5.23248 10.7209 8.13639 10.7209H9.2333V13.8882C9.2333 14.1866 9.40507 14.4547 9.6673 14.5657C9.92682 14.6777 10.2286 14.6096 10.4244 14.3951L16.4261 7.8165C16.6846 7.53293 16.6846 7.08662 16.4261 6.80198Z" fill="#469BFC"/>
                            </svg>
                        </div>
                        <a href="/manual.pdf" class="book" target="_blank">
                            <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clipssa0)">
                                    <path d="M2.60082 2.00618C2.60036 2.00618 2.59985 2.00618 2.59939 2.00618C2.4386 2.00618 2.28738 2.06886 2.17318 2.18276C2.05773 2.29793 1.99414 2.45127 1.99414 2.61452V11.7365C1.99414 12.071 2.26734 12.3438 2.60322 12.3446C4.01921 12.348 6.39154 12.6431 8.02813 14.3558V4.80942C8.02813 4.69602 7.99916 4.5895 7.9445 4.50135C6.60127 2.33817 4.02001 2.0095 2.60082 2.00618Z" fill="#469BFC"/>
                                    <path d="M15.0066 11.7364V2.61446C15.0066 2.45121 14.943 2.29787 14.8275 2.1827C14.7134 2.0688 14.562 2.00612 14.4014 2.00612C14.4009 2.00612 14.4004 2.00612 14.3999 2.00612C12.9808 2.0095 10.3995 2.33816 9.05623 4.50135C9.00156 4.5895 8.97266 4.69602 8.97266 4.80941V14.3557C10.6092 12.6431 12.9816 12.3479 14.3976 12.3446C14.7334 12.3437 15.0066 12.0709 15.0066 11.7364Z" fill="#469BFC"/>
                                    <path d="M16.3927 4.10986H15.9516V11.7365C15.9516 12.5905 15.2557 13.287 14.4004 13.2891C13.1993 13.292 11.2189 13.5268 9.81641 14.8542C12.2421 14.2603 14.7992 14.6464 16.2565 14.9785C16.4385 15.0199 16.6265 14.9771 16.7723 14.8609C16.9176 14.745 17.0009 14.5718 17.0009 14.3858V4.71809C17.001 4.38272 16.728 4.10986 16.3927 4.10986Z" fill="#469BFC"/>
                                    <path d="M1.04931 11.7365V4.10986H0.608224C0.272917 4.10986 0 4.38272 0 4.71809V14.3856C0 14.5717 0.0833403 14.7449 0.228614 14.8608C0.374287 14.9769 0.562147 15.0199 0.744396 14.9783C2.20171 14.6462 4.75887 14.2602 7.18444 14.8541C5.78197 13.5267 3.8016 13.2919 2.60055 13.289C1.74522 13.287 1.04931 12.5905 1.04931 11.7365Z" fill="#469BFC"/>
                                </g>
                                <defs>
                                    <clipPath id="clipssa0">
                                        <rect width="17" height="17" fill="white"/>
                                    </clipPath>
                                </defs>
                            </svg>
                        </a>
                    </div>
                    <div v-else>
                        <div v-if="account.isFollowing" class="buttons">
                            <a href="javascript:void(0)" @click="openChat(account.id)" class="page-account__btnChat">
                                <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0)">
                                        <path
                                            d="M14.8425 6.81468C14.6883 6.49643 14.4314 6.23948 14.1132 6.08537L2.25656 0.348016C1.4755 -0.0303899 0.535612 0.296054 0.157206 1.07711C-0.035573 1.47507 -0.0517786 1.93585 0.11261 2.34636L2.17434 7.49967L0.11261 12.6535C-0.208524 13.462 0.186548 14.3777 0.995015 14.6988C1.17782 14.7714 1.37262 14.8091 1.56933 14.81C1.80732 14.81 2.04224 14.7563 2.25656 14.6529L14.1131 8.91398C14.8943 8.53566 15.2208 7.59577 14.8425 6.81468ZM1.80032 13.7085C1.53993 13.8345 1.22665 13.7256 1.1006 13.4652C1.03636 13.3326 1.03102 13.179 1.08583 13.0422L3.09308 8.02347H13.549L1.80032 13.7085ZM3.09311 6.97585L1.08586 1.95715C1.00232 1.7571 1.05419 1.52608 1.21523 1.38097C1.37112 1.22907 1.6065 1.19344 1.80032 1.29245L13.549 6.97585H3.09311Z"
                                            fill="black"/>
                                    </g>
                                    <defs>
                                        <clipPath id="clip0">
                                            <rect width="15" height="15" fill="white"/>
                                        </clipPath>
                                    </defs>
                                </svg>
                                Написать
                            </a>
                            <a href="javascript:void(0)" class="page-account__btnTip support btn-popups"
                               data-href="#popups-tip"
                               :data-id="`${account.id}`"
                               :data-cloud-token="`${account.cloud_token}`"
                               :data-avatar="`${account.avatar}`"
                               :data-name="`${account.name}`"
                               :data-username="`${account.username}`"
                            >
                                <svg width="15" height="15" viewBox="0 0 15 15" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0)">
                                        <path
                                            d="M12.8021 2.19837C9.87179 -0.73192 5.12862 -0.73236 2.19792 2.19837C-0.732404 5.12864 -0.732874 9.87187 2.19792 12.8026C5.12821 15.7329 9.87138 15.7333 12.8021 12.8026C15.7324 9.87231 15.7328 5.12908 12.8021 2.19837V2.19837ZM7.49997 13.767C4.04461 13.767 1.23345 10.9558 1.23345 7.50046C1.23345 4.0451 4.04461 1.23397 7.49997 1.23397C10.9553 1.23397 13.7665 4.04513 13.7665 7.50049C13.7665 10.9558 10.9554 13.767 7.49997 13.767V13.767Z"
                                            fill="#1D1D1F"/>
                                        <path
                                            d="M8.43795 3.75586H6.24808C5.90793 3.75586 5.63219 4.03161 5.63219 4.37176V6.88424H4.99676C4.65661 6.88424 4.38086 7.15998 4.38086 7.50013C4.38086 7.84029 4.65661 8.11603 4.99676 8.11603H5.63219V8.76126H4.99676C4.65661 8.76126 4.38086 9.037 4.38086 9.37716C4.38086 9.71731 4.65661 9.99305 4.99676 9.99305H5.63219V10.6285C5.63219 10.9687 5.90793 11.2444 6.24808 11.2444C6.58824 11.2444 6.86398 10.9687 6.86398 10.6285V9.99305H8.1251C8.46526 9.99305 8.741 9.71731 8.741 9.37716C8.741 9.037 8.46526 8.76126 8.1251 8.76126H6.86398V8.11603H8.43795C9.64004 8.11603 10.618 7.13805 10.618 5.93596C10.618 4.73385 9.64006 3.75586 8.43795 3.75586V3.75586ZM8.43795 6.88421H6.86398V4.98763H8.43795C8.96082 4.98763 9.38623 5.413 9.38623 5.9359C9.38623 6.4588 8.96085 6.88421 8.43795 6.88421V6.88421Z"
                                            fill="#1D1D1F"/>
                                    </g>
                                    <defs>
                                        <clipPath id="clip0">
                                            <rect width="15" height="15" fill="white"/>
                                        </clipPath>
                                    </defs>
                                </svg>
                                Подарить</a>
                        </div>
                        <a v-else @click="$router.push({name: 'payment', params:{id: account.id}}); setMenu(false)"  class="page-account__btnSubscribe">
                            {{ account.button_text || 'Подружиться' }}
                        </a>
                    </div>
                </div>
                <div v-else>
                    <a @click="$router.push({name: 'payment', params:{id: account.id}}); setMenu(false)" class="page-account__btnSubscribe">
                        {{ account.button_text || 'Подружиться' }}
                    </a>
                </div>
                <div v-if="account.url" class="page-account__social">
                    <a href="#">
                        <a style="max-width: 100%" :href=`/account/${account.url}`>
                            <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0)">
                                    <path
                                        d="M7.24528 4.21044C7.18147 4.12837 7.11767 4.03728 7.04011 3.95972C6.96276 3.88237 6.87618 3.81405 6.79411 3.75024L5.85976 4.68439C5.95558 4.73466 6.04667 4.78923 6.12874 4.8713C6.50687 5.24964 6.50687 5.86023 6.12874 6.23857L2.93831 9.42878C2.56019 9.80712 1.94938 9.80712 1.57105 9.42878C1.19292 9.05066 1.19292 8.43986 1.57105 8.06152L2.82896 6.80382C2.59671 6.31612 2.5054 5.76913 2.5647 5.24513L0.659678 7.15015C-0.219893 8.02972 -0.219893 9.46079 0.659678 10.3404C1.53925 11.2199 2.97032 11.2199 3.84989 10.3404L7.04011 7.15015C7.84792 6.34233 7.89927 5.07175 7.2498 4.20593L7.24528 4.21044Z"
                                        fill="#989899"/>
                                    <path
                                        d="M10.3405 0.659678C9.46068 -0.219893 8.02961 -0.219893 7.15004 0.659678L3.85004 3.95968C3.04201 4.76771 2.99109 6.03829 3.64035 6.9039L3.64486 6.89939C3.70867 6.98146 3.77248 7.07255 3.85004 7.15011C3.92759 7.22745 4.01418 7.29599 4.09625 7.35958L5.03039 6.42544C4.93478 6.37517 4.84347 6.3206 4.76162 6.23853C4.38328 5.86019 4.38328 5.2496 4.76162 4.87126L8.06162 1.57126C8.43996 1.19292 9.05054 1.19292 9.42888 1.57126C9.80722 1.9496 9.80722 2.56019 9.42888 2.93853L8.06119 4.30622C8.29365 4.79392 8.38474 5.34069 8.32545 5.86491L10.3405 3.84989C11.22 2.97032 11.22 1.53925 10.3405 0.659678Z"
                                        fill="#989899"/>
                                </g>
                                <defs>
                                    <clipPath id="clip0">
                                        <rect width="11" height="11" fill="white"/>
                                    </clipPath>
                                </defs>
                            </svg>
                            <span>
                                {{ account.url }}
                                </span>
                        </a>
                    </a>
                </div>

                <div v-if="!loadVideo" class="page-account__videoPreloader"></div>
                <div class="page-account__list" v-else-if="videosCount > 0" >
                    <ul class="videoWrapp">
                        <account-video v-if="loadVideo" v-for="(item, index) in videos"
                                       :index="index"
                                       :key="item.id"
                                       :item="item"
                                       :user="getUser"
                                       :account="account"
                                       :card_exist="account.cards.length < 0 ? 1 : 0"
                                       @video-clicked="openVideo"
                        >
                        </account-video>
                    </ul>

                    <div class="page-account__videoPreloader post_load" v-if="!videoLoading"></div>
                </div>
                <div v-else class="page-account__none">
                    <h4>В профиле пока нет ни <br> одной публикации </h4>

                </div>
            </div>
        </div>
        <div class="popups popupsBottom ">
            <div class="popups__bgClose"></div>
            <div class="popups__content">
                <div class="popups__content-box">

                    <div class="logo">
                        <img src="/image/error-balance.png" alt="">
                    </div>
                    <p>
                        К сожалению на вашей привязанной карте **** 9263 не достаточно средств, пожалуйста пополните ее или
                    </p>
                </div>
                <div class="popups__content-buttons">
                    <div class="btn">Привязать новую карту</div>
                </div>
            </div>
            <div class="popups__footer">
                <div class="btn close">Отмена</div>
            </div>
        </div>
        <div class="popups popupsBottom popupsAnim popupsMenu" :class="{active: classes.popupsMenu}">
            <div class="popups__bgClose" :class="{active: classes.popupsMenu}" @click="switchOffClass('popupsMenu')"></div>
            <div class="popupsAnim__content" :class="{active: classes.popupsMenu_content}">
                <div class="popups__content">
                    <div class="popups__content-box">
                        <ul>
                            <li>
                                <a @click="$router.push({name: 'followers'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="27" height="27" rx="7" fill="#4892F3"/>
                                            <path d="M14 6C9.58881 6 6 9.58872 6 14C6 18.4112 9.58881 22 14 22C18.4111 22 21.9999 18.4112 21.9999 14C21.9999 9.58872 18.4112 6 14 6ZM18.5937 12.6487L13.5677 17.6747C13.354 17.8884 13.0699 18.006 12.7677 18.006C12.4655 18.006 12.1815 17.8884 11.9678 17.6747L9.40624 15.1131C9.19254 14.8994 9.07483 14.6154 9.07483 14.3132C9.07483 14.0109 9.19254 13.7268 9.40624 13.5131C9.61986 13.2994 9.90394 13.1817 10.2062 13.1817C10.5084 13.1817 10.7926 13.2994 11.0062 13.5132L12.7677 15.2746L16.9936 11.0487C17.2073 10.835 17.4913 10.7173 17.7935 10.7173C18.0957 10.7173 18.3798 10.835 18.5935 11.0487C19.0348 11.4899 19.0348 12.2076 18.5937 12.6487Z" fill="white"/>
                                        </svg>
                                    </div>
                                    <span>Мои Друзья</span>
                                </a>
                            </li>
                            <li>
                                <a @click="$router.push({name: 'menu'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="26" height="26" rx="7" fill="#4892F3"/>
                                            <path d="M20.6235 11.1782L19.3938 10.9109C19.2869 10.5835 19.1544 10.2642 18.998 9.95654L19.6788 8.89758C19.8004 8.70837 19.7737 8.45996 19.6147 8.30103L17.699 6.38525C17.54 6.22632 17.2916 6.19958 17.1024 6.32117L16.0435 7.00195C15.7358 6.84558 15.4165 6.71313 15.0891 6.6062L14.8218 5.37646C14.774 5.15674 14.5795 5 14.3546 5H11.6454C11.4205 5 11.226 5.15674 11.1782 5.37646L10.9109 6.6062C10.5835 6.71313 10.2642 6.84558 9.95654 7.00195L8.89758 6.32117C8.70837 6.19958 8.45996 6.22632 8.30103 6.38525L6.38525 8.30103C6.22632 8.45996 6.19958 8.70837 6.32117 8.89758L7.00195 9.95654C6.84558 10.2642 6.71313 10.5835 6.6062 10.9109L5.37646 11.1782C5.15674 11.2261 5 11.4205 5 11.6454V14.3546C5 14.5795 5.15674 14.7739 5.37646 14.8218L6.6062 15.0891C6.71313 15.4165 6.84558 15.7358 7.00195 16.0435L6.32117 17.1024C6.19958 17.2916 6.22632 17.54 6.38525 17.699L8.30103 19.6147C8.45996 19.7737 8.70837 19.8004 8.89758 19.6788L9.95654 18.998C10.2642 19.1544 10.5835 19.2869 10.9109 19.3938L11.1782 20.6235C11.226 20.8433 11.4205 21 11.6454 21H14.3546C14.5795 21 14.774 20.8433 14.8218 20.6235L15.0891 19.3938C15.4165 19.2869 15.7358 19.1544 16.0435 18.998L17.1024 19.6788C17.2916 19.8004 17.54 19.7738 17.699 19.6147L19.6147 17.699C19.7737 17.54 19.8004 17.2916 19.6788 17.1024L18.998 16.0435C19.1544 15.7358 19.2869 15.4165 19.3938 15.0891L20.6235 14.8218C20.8433 14.7739 21 14.5795 21 14.3546V11.6454C21 11.4205 20.8433 11.2261 20.6235 11.1782ZM15.8685 13C15.8685 14.5817 14.5817 15.8685 13 15.8685C11.4183 15.8685 10.1315 14.5817 10.1315 13C10.1315 11.4183 11.4183 10.1315 13 10.1315C14.5817 10.1315 15.8685 11.4183 15.8685 13Z" fill="white"/>
                                        </svg>
                                    </div>
                                    <span>Настройки</span>
                                </a>
                            </li>
                            <li>
                                <a @click="$router.push({name: 'withdrawal'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="26" height="26" rx="7" fill="#36CC76"/>
                                            <path d="M14.408 15.176H11.51V16.634H15.974V17.858H11.51V20H9.854V17.858H8.324V16.634H9.854V15.176H8.324V13.664H9.854V7.4H14.408C15.5 7.4 16.43 7.784 17.198 8.552C17.966 9.308 18.35 10.226 18.35 11.306C18.35 12.386 17.966 13.304 17.198 14.06C16.442 14.804 15.512 15.176 14.408 15.176ZM11.51 8.966V13.664H14.408C15.032 13.664 15.566 13.436 16.01 12.98C16.466 12.512 16.694 11.954 16.694 11.306C16.694 10.658 16.472 10.106 16.028 9.65C15.584 9.194 15.044 8.966 14.408 8.966H11.51Z" fill="white"/>
                                        </svg>
                                    </div>
                                    <span>Деньги</span>
                                </a>
                            </li>
                            <li>
                                <a @click="$router.push({name: 'management'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="26" height="26" rx="7" fill="#EA8325"/>
                                            <path d="M18.8033 9.40535C18.8033 8.38325 18.8033 7.66821 18.8033 7.60038C18.8033 6.84128 18.2985 6.22371 17.678 6.22371H17.528V7.90631C17.528 8.15974 17.36 8.3652 17.1529 8.3652C16.9457 8.3652 16.7778 8.15974 16.7778 7.90631C16.7778 7.39116 16.7778 5.97187 16.7778 5.45889C16.7778 5.20546 16.6098 5 16.4027 5C16.1955 5 16.0276 5.20546 16.0276 5.45889V6.22371H13.5269V7.90631C13.5269 8.15974 13.359 8.3652 13.1518 8.3652C12.9447 8.3652 12.7767 8.15974 12.7767 7.90631C12.7767 7.39116 12.7767 5.97187 12.7767 5.45889C12.7767 5.20546 12.6088 5 12.4016 5C12.1945 5 12.0265 5.20546 12.0265 5.45889V6.22371H9.5259V7.90631C9.5259 8.15974 9.35796 8.3652 9.15081 8.3652C8.94365 8.3652 8.77571 8.15974 8.77571 7.90631C8.77571 7.39116 8.77571 5.97187 8.77571 5.45889C8.77571 5.20546 8.60777 5 8.40062 5C8.19346 5 8.02552 5.20546 8.02552 5.45889V6.22371H7.12529C6.5048 6.22371 6 6.84128 6 7.60038V9.40535H18.8033Z" fill="white"/>
                                            <path d="M6 10.3228V17.7568C6 18.5159 6.5048 19.1335 7.12529 19.1335H17.678C18.2985 19.1335 18.8033 18.5159 18.8033 17.7568C18.8033 17.5602 18.8033 13.2654 18.8033 10.3228C18.5698 10.3228 6.12913 10.3228 6 10.3228ZM9.60092 16.686H8.80072C8.59356 16.686 8.42562 16.4806 8.42562 16.2272C8.42562 15.9737 8.59356 15.7683 8.80072 15.7683H9.60092C9.80808 15.7683 9.97602 15.9737 9.97602 16.2272C9.97602 16.4806 9.80808 16.686 9.60092 16.686ZM9.60092 14.7281H8.80072C8.59356 14.7281 8.42562 14.5226 8.42562 14.2692C8.42562 14.0158 8.59356 13.8103 8.80072 13.8103H9.60092C9.80808 13.8103 9.97602 14.0158 9.97602 14.2692C9.97602 14.5226 9.80808 14.7281 9.60092 14.7281ZM9.60092 12.7702H8.80072C8.59356 12.7702 8.42562 12.5647 8.42562 12.3113C8.42562 12.0579 8.59356 11.8524 8.80072 11.8524H9.60092C9.80808 11.8524 9.97602 12.0579 9.97602 12.3113C9.97602 12.5647 9.80808 12.7702 9.60092 12.7702ZM12.8017 16.686H12.0015C11.7944 16.686 11.6264 16.4806 11.6264 16.2272C11.6264 15.9737 11.7944 15.7683 12.0015 15.7683H12.8017C13.0089 15.7683 13.1768 15.9737 13.1768 16.2272C13.1768 16.4806 13.0089 16.686 12.8017 16.686ZM12.8017 14.7281H12.0015C11.7944 14.7281 11.6264 14.5226 11.6264 14.2692C11.6264 14.0158 11.7944 13.8103 12.0015 13.8103H12.8017C13.0089 13.8103 13.1768 14.0158 13.1768 14.2692C13.1768 14.5226 13.0089 14.7281 12.8017 14.7281ZM12.8017 12.7702H12.0015C11.7944 12.7702 11.6264 12.5647 11.6264 12.3113C11.6264 12.0579 11.7944 11.8524 12.0015 11.8524H12.8017C13.0089 11.8524 13.1768 12.0579 13.1768 12.3113C13.1768 12.5647 13.0089 12.7702 12.8017 12.7702ZM16.0026 16.686H15.2024C14.9952 16.686 14.8273 16.4806 14.8273 16.2272C14.8273 15.9737 14.9952 15.7683 15.2024 15.7683H16.0026C16.2097 15.7683 16.3777 15.9737 16.3777 16.2272C16.3777 16.4806 16.2097 16.686 16.0026 16.686ZM16.0026 14.7281H15.2024C14.9952 14.7281 14.8273 14.5226 14.8273 14.2692C14.8273 14.0158 14.9952 13.8103 15.2024 13.8103H16.0026C16.2097 13.8103 16.3777 14.0158 16.3777 14.2692C16.3777 14.5226 16.2097 14.7281 16.0026 14.7281ZM16.0026 12.7702H15.2024C14.9952 12.7702 14.8273 12.5647 14.8273 12.3113C14.8273 12.0579 14.9952 11.8524 15.2024 11.8524H16.0026C16.2097 11.8524 16.3777 12.0579 16.3777 12.3113C16.3777 12.5647 16.2097 12.7702 16.0026 12.7702Z" fill="white"/>
                                            <rect x="13.5" y="13.5332" width="7.5" height="7.46667" rx="3.73333" fill="white"/>
                                            <path d="M18.7893 16.4125L18.1939 15.7012C18.1655 15.6673 18.1228 15.6571 18.0857 15.6756C18.0486 15.6941 18.0244 15.737 18.0244 15.7849V16.1406H16.7342C16.1312 16.1406 15.6426 16.7243 15.6426 17.4445C15.6426 17.51 15.687 17.5631 15.7418 17.5631H16.1388C16.1936 17.5631 16.238 17.51 16.238 17.4445C16.238 17.1171 16.4601 16.8518 16.7342 16.8518H18.0244V17.2074C18.0244 17.2553 18.0486 17.2987 18.0857 17.317C18.1228 17.3355 18.1655 17.3253 18.1939 17.2914L18.7893 16.5801C18.828 16.5339 18.828 16.4587 18.7893 16.4125Z" fill="#EA8325"/>
                                            <path d="M18.7191 17.563H18.3221C18.2674 17.563 18.2229 17.6161 18.2229 17.6815C18.2229 18.009 18.0008 18.2743 17.7267 18.2743H16.4366V17.9186C16.4366 17.8707 16.4123 17.8273 16.3752 17.8091C16.3381 17.7908 16.2956 17.801 16.2671 17.8349L15.6716 18.5462C15.6329 18.5924 15.6329 18.6676 15.6716 18.7138L16.2671 19.4251C16.2954 19.459 16.3381 19.4692 16.3752 19.4507C16.4123 19.4322 16.4366 19.389 16.4366 19.3412V18.9855H17.7267C18.3297 18.9855 18.8183 18.4018 18.8183 17.6815C18.8183 17.6161 18.7739 17.563 18.7191 17.563Z" fill="#EA8325"/>
                                        </svg>
                                    </div>
                                    <span>Подписки</span>
                                </a>
                            </li>
                            <li>
                                <a @click="$router.push({name: 'legal'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="26" height="26" rx="7" fill="#9F9F9F"/>
                                            <path d="M8.3125 21H17.6875C18.4629 21 19.0938 20.3692 19.0938 19.5938V9.6875H15.8125C15.0371 9.6875 14.4062 9.05669 14.4062 8.28125V5H8.3125C7.53706 5 6.90625 5.63081 6.90625 6.40625V19.5938C6.90625 20.3692 7.53706 21 8.3125 21ZM10.1875 11.5938H15.8125C16.0716 11.5938 16.2812 11.8034 16.2812 12.0625C16.2812 12.3216 16.0716 12.5312 15.8125 12.5312H10.1875C9.92841 12.5312 9.71875 12.3216 9.71875 12.0625C9.71875 11.8034 9.92841 11.5938 10.1875 11.5938ZM10.1875 13.4688H15.8125C16.0716 13.4688 16.2812 13.6784 16.2812 13.9375C16.2812 14.1966 16.0716 14.4062 15.8125 14.4062H10.1875C9.92841 14.4062 9.71875 14.1966 9.71875 13.9375C9.71875 13.6784 9.92841 13.4688 10.1875 13.4688ZM10.1875 15.3438H15.8125C16.0716 15.3438 16.2812 15.5534 16.2812 15.8125C16.2812 16.0716 16.0716 16.2812 15.8125 16.2812H10.1875C9.92841 16.2812 9.71875 16.0716 9.71875 15.8125C9.71875 15.5534 9.92841 15.3438 10.1875 15.3438ZM10.1875 17.2188H13.9375C14.1966 17.2188 14.4062 17.4284 14.4062 17.6875C14.4062 17.9466 14.1966 18.1562 13.9375 18.1562H10.1875C9.92841 18.1562 9.71875 17.9466 9.71875 17.6875C9.71875 17.4284 9.92841 17.2188 10.1875 17.2188Z" fill="white"/>
                                            <path d="M15.8125 8.74976H18.8191L15.3438 5.27441V8.28101C15.3438 8.53963 15.5539 8.74976 15.8125 8.74976Z" fill="white"/>
                                        </svg>
                                    </div>
                                    <span>Юридическая информация </span>
                                </a>
                            </li>
                            <li>
                                <a @click="$router.push({name: 'FAQ'})">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="27" height="27" rx="7" fill="#F19A37"/>
                                            <path d="M19.3789 16.2775C19.4855 16.0524 19.5782 15.823 19.6575 15.5898H19.6371C21.026 11.5074 18.1051 7.21663 13.793 7.00771C13.793 7.00748 13.7929 7.00726 13.7929 7.00704C10.0826 6.83582 7 9.8107 7 13.4995C7 17.0805 9.90636 19.994 13.4811 19.9992C14.4507 19.9979 15.3801 19.7888 16.2468 19.3771C19.6296 20.0469 19.3658 19.9993 19.4435 19.9993C19.7951 19.9993 20.0577 19.6767 19.989 19.3329L19.3789 16.2775Z" fill="white"/>
                                        </svg>
                                    </div>
                                    <span>Помощь</span>
                                </a>
                            </li>
                            <li v-if="getUser && !getUser.referrer_id">
                                <a href="https://friendsonlypartner.com" target="_blank">
                                    <div class="icon">
                                        <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="27" height="27" rx="7" fill="#129388"/>
                                            <g clip-path="url(#xzclip0)">
                                                <path d="M18.5161 19.9718H9.48387C9.19884 19.9718 8.96774 19.7262 8.96774 19.4234V17.7998C8.96774 17.0264 9.39723 16.3228 10.0619 16.0075C11.9952 15.0903 11.8892 15.1214 12.0398 15.1214H12.6533C12.8908 15.1214 13.0977 15.2936 13.1545 15.5387C13.3708 16.4729 14.6291 16.4733 14.8455 15.5387C14.9023 15.2937 15.1092 15.1214 15.3467 15.1214C16.0069 15.1214 16.0408 15.1074 16.1706 15.169L17.9381 16.0075C18.6028 16.3228 19.0323 17.0264 19.0323 17.7998V19.4234C19.0323 19.7262 18.8012 19.9718 18.5161 19.9718ZM14.0126 7.0282C12.2742 7.0282 10.86 8.53085 10.86 10.3779C10.86 12.2249 12.2742 13.7276 14.0126 13.7276C15.751 13.7276 17.1653 12.2249 17.1653 10.3779C17.1653 8.53085 15.751 7.0282 14.0126 7.0282ZM9.03929 10.6111C7.94474 10.6111 7.05426 11.5572 7.05426 12.7202C7.05426 13.8832 7.94474 14.8293 9.03929 14.8293C10.1339 14.8293 11.0244 13.8832 11.0244 12.7202C11.0243 11.5572 10.1338 10.6111 9.03929 10.6111ZM18.9607 10.6111C17.8661 10.6111 16.9756 11.5572 16.9756 12.7202C16.9756 13.8832 17.8661 14.8293 18.9607 14.8293C20.0553 14.8293 20.9457 13.8832 20.9457 12.7202C20.9457 11.5572 20.0553 10.6111 18.9607 10.6111ZM21.2548 15.6349C20.1809 15.1253 20.2066 15.1201 20.0597 15.1201C19.2909 15.1201 18.7879 15.1144 18.4477 15.1126C18.1096 15.1108 17.9976 15.5927 18.2972 15.7592C18.5425 15.8955 18.6915 16.0118 18.8684 16.2169C19.3846 16.8127 19.4327 17.4431 19.4326 17.9658C19.4326 18.1551 19.5769 18.3083 19.7551 18.3083H21.4839C21.769 18.3083 22 18.0626 22 17.76V16.8554C22 16.3286 21.7074 15.8498 21.2548 15.6349ZM7.94032 15.1201C7.79406 15.1201 7.82284 15.1236 6.74516 15.6349C6.29258 15.8498 6 16.3286 6 16.8554V17.7599C6 18.0626 6.23097 18.3083 6.51613 18.3083H8.24477C8.42303 18.3083 8.56748 18.1549 8.56726 17.9655C8.56668 17.441 8.61335 16.815 9.13161 16.2169C9.30765 16.0128 9.45784 15.8955 9.69774 15.7616C9.99674 15.5947 9.88626 15.1142 9.54852 15.1149C9.20629 15.1155 8.70342 15.1201 7.94032 15.1201Z" fill="white"/>
                                            </g>
                                            <defs>
                                                <clipPath id="xzclip0">
                                                    <rect width="16" height="17" fill="white" transform="translate(6 5)"/>
                                                </clipPath>
                                            </defs>
                                        </svg>
                                    </div>
                                    <span>Партнерская программа</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="load-payment">
            <img src="/image/load/load-new.gif" alt="">
            <p>Ваш платеж обрабатывается, пожалуйста подождите</p>
        </div>
        <div class="popups popupsBottom popupsAnim" :class="{active: classes.popupsAccountMenu}">
            <div class="popups__bgClose" :class="{active: classes.popupsAccountMenu}" @click="switchOffClass('popupsAccountMenu')"></div>
            <div class="popupsAnim__content" :class="{active: classes.popupsAccountMenu_content}">
                <div class="popups__content">
                    <a href="javascript:void(0)" @click="share(account.name,'',account.username)" class="refs"  v-if="canShare">
                        Поделиться
                    </a>
                    <div class="popups__content-buttons">
                        <div class="report" @click="switchOffClass('popupsAccountMenu');switchOnClass('popupsAccountReport')">Пожаловаться</div>
                    </div>
                </div>
                <div class="popups__footer">
                    <div class="btn close" @click="switchOffClass('popupsAccountMenu')">Отмена</div>
                </div>
            </div>
        </div>
        <div class="popups popupsReport popupsAnim" :class="{active: classes.popupsAccountReport}" >
            <div class="popups__bgClose" :class="{active: classes.popupsAccountReport}" @click="switchOffClass('popupsAccountReport')"></div>
            <div class="popupsAnim__content" :class="{active: classes.popupsAccountReport_content}">
                <div class="popups__content">
                    <div class="close">
                        <svg width="21" height="12" viewBox="0 0 21 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18.8916 0.834022L10.5036 8.84302L2.1289 0.820074L1.95625 0.654668L1.78331 0.819786L0.835087 1.72517L0.646098 1.90562L0.834722 2.08645L10.3288 11.1882L10.502 11.3543L10.6751 11.1879L11.6227 10.2767L11.6233 10.2761L20.1836 2.10261L20.3727 1.9221L20.1839 1.74127L19.2372 0.83431L19.0645 0.668904L18.8916 0.834022Z" fill="#2F80ED" stroke="#2F80ED" stroke-width="0.5"/>
                        </svg>
                    </div>
                    <div class="back none">
                        <svg width="12" height="19" viewBox="0 0 12 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11.1708 2.03017L3.18474 9.5L11.1708 16.9698L11.366 17.1524L11.1708 17.335L10.2646 18.1826L10.0939 18.3423L9.92312 18.1826L0.829288 9.68264L0.633266 9.49942L0.829867 9.31682L1.74182 8.46983L1.74246 8.46922L9.92305 0.817421L10.0938 0.657683L10.2646 0.817421L11.1708 1.66502L11.366 1.8476L11.1708 2.03017Z" fill="#2F80ED" stroke="#2F80ED" stroke-width="0.5"/>
                        </svg>
                    </div>
                    <div class="popups__content-title">
                        Cообщить
                    </div>
                    <div class="popups__content-nav ">
                        <p>Выберите причину</p>
                        <div class="btnReport">Пожаловатся на аккаунт</div>
                        <div class="btnReport">Пожаловатся на контент</div>
                    </div>
                    <div class="popups__content-form none">
                        <h2>Причина жалобы: <span>Пожаловаться на контент</span></h2>
                        <div class="form">
                            <div class="form__textarea">
                                <label>Описание жалобы (необязательно)</label>
                                <textarea v-model="descReport" oninput="textarea_resize(event,16,1)" id="desc__textareaReport" placeholder="Расскажите как можно подробнее"></textarea>
                                <div id="desc__textareaReport_div"></div>
                                <div class="max-length">
                                    <span>0</span>/200
                                </div>
                            </div>
                            <div class="form__file" id="fileReport" >
                                <label for="fileRep">
                                    <svg width="26" height="19" viewBox="0 0 26 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M22.8214 0.74707H3.17857C1.69924 0.74707 0.5 1.94631 0.5 3.42564V15.9256C0.5 17.4049 1.69924 18.6042 3.17857 18.6042H22.8214C24.3008 18.6042 25.5 17.4049 25.5 15.9256V3.42564C25.5 1.94631 24.3008 0.74707 22.8214 0.74707ZM23.7143 15.9256C23.7143 16.4187 23.3145 16.8185 22.8214 16.8185H3.17857C2.68544 16.8185 2.2857 16.4187 2.2857 15.9256V15.4024L5.85714 11.831L8.79734 14.7712C9.14597 15.1197 9.71119 15.1197 10.0598 14.7712L17.4643 7.36669L23.7143 13.6167V15.9256H23.7143ZM23.7143 11.0917L18.0955 5.47297C17.7469 5.12439 17.1817 5.12439 16.833 5.47297L9.42858 12.8774L6.48838 9.93718C6.13975 9.5886 5.57453 9.5886 5.2259 9.93718L2.2857 12.8774V3.42564C2.2857 2.93251 2.68544 2.53277 3.17857 2.53277H22.8214C23.3146 2.53277 23.7143 2.93251 23.7143 3.42564V11.0917H23.7143Z" fill="#828282"/>
                                    </svg>
                                    <span>0</span>/1
                                </label>
                                <input type="file" ref="fileReport" name="file" id="fileRep" onchange="reportImg(this.account)" required multiple>
                                <div class="list-img" id="listReportImg">

                                </div>
                            </div>
                            <button id="fileReportBTN" @click="addReport">Отправить</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="popups popupsBottom popupsReportSuccess popupsAnim" id="popupsAccountReportSuccess">
            <div class="popups__bgClose"></div>
            <div class="popupsAnim__content">
                <div class="popups__content">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M29.9984 57.6751C45.2836 57.6751 57.6746 45.2841 57.6746 29.9989C57.6746 14.7138 45.2836 2.32275 29.9984 2.32275C14.7133 2.32275 2.32227 14.7138 2.32227 29.9989C2.32227 45.2841 14.7133 57.6751 29.9984 57.6751Z" fill="#2F80ED"/>
                        <path d="M30 60C13.4593 60 0 46.543 0 30C0 13.4593 13.4593 0 30 0C46.543 0 60 13.4593 60 30C60 46.543 46.543 60 30 60ZM30 4.64754C16.0201 4.64754 4.64754 16.0201 4.64754 30C4.64754 43.9799 16.0201 55.3525 30 55.3525C43.9799 55.3525 55.3525 43.9775 55.3525 30C55.3525 16.0201 43.9799 4.64754 30 4.64754Z" fill="#2F80ED"/>
                        <path d="M26.3769 41.0375C25.7541 41.0375 25.1592 40.7888 24.72 40.3427L16.1452 31.6285C15.2459 30.7129 15.2575 29.2443 16.1731 28.3427C17.0887 27.4458 18.5596 27.455 19.4589 28.3706L26.3095 35.3326L40.4823 19.7238C41.349 18.7734 42.8177 18.706 43.7634 19.5658C44.7138 20.428 44.7835 21.8966 43.9214 22.8493L28.0965 40.2775C27.6666 40.7516 27.0624 41.0258 26.4234 41.0397C26.4071 41.0375 26.3932 41.0375 26.3769 41.0375Z" fill="white"/>
                    </svg>
                    <p>Ваш запрос успешно оформлен, мы примем все необходимые меры, исходя от вашего запроса</p>
                </div>
                <div class="popups__footer">
                    <div class="btn close">Закрыть</div>
                </div>
            </div>
        </div>
        <div v-if="0" class="popups popupsContent18 active">
            <div class="popups__bgClose"></div>
            <div class="popups__content ">
                <div class="logo">
                    <img src="/image/logo-content18.svg" alt="">
                </div>
                <p>
                    Страница сайта предназначена для лиц старше 18 лет. Чтобы подтвердить, что вы уже достигли совершеннолетия, нажмите на кнопку ниже
                </p>
                <div class="btn close">Подтвердить</div>
            </div>
        </div>

        <account-slider
            v-if="choseVideo.load"
            :key="videosCount"
            v-bind:selected="choseVideo"
            v-bind:getUser="getUser"
            v-bind:videos="videos"
            v-bind:videosCount="videosCount"
            @load-new="scroll('swipe')"
            @video-close="closeVideo"
            @item-removed="deletedVideo"
        ></account-slider>

    </div>
</template>
<script>
import AccountVideo from "./AccountVideo";
import AccountSlider from "./AccountSlider";
import {mapGetters, mapMutations} from 'vuex'
import { SET_LOAD, SET_USER, SET_MENU } from '../store/types'
const Account = {
    data: () => ({
        lastTimeOnline: 'был(а) недавно',
        backHref: '/menu',
        videosCount: 0,
        isFollowing: false,
        verity: false,
        videos: [],
        loadVideo:false,
        account: {
            username: "Friendsonly"
        },
        descReport:'',
        classes:{
            popupsMenu: false,
            popupsMenu_content: false,
            popupsAccountMenu: false,
            popupsAccountMenu_content: false,
            popupsAccountReport: false,
            popupsAccountReport_content: false,
        },
        choseVideo: {
            index: '',
            src: '',
            load: false
        },
        prevRoute: '',
        videoLoading: true,
        allVideoLoad: false,
    }),
    async beforeMount() {
        this.setLoad(true)
        await this.loadInfoAccount(this.$router.currentRoute.params.username)
        this.$forceUpdate();
        this.scroll('scroll');
    },
    mounted() {
        //socket place
    },
    computed: {
        ...mapGetters([
            'getUser',
            'getLoad',
            'getSocket'
        ]),
        getFirstLetter(){
            return this.account.username.slice(0,1)
        },
        canShare(){
            return navigator.share !== undefined
        }
    },
    methods: {
        ...mapMutations({
            setLoad: SET_LOAD,
            setUser: SET_USER,
            setMenu: SET_MENU
        }),
        deletedVideo: function(index) {
            this.videosCount = this.videosCount - 1;
            this.videos.splice(index, 1);
            this.$forceUpdate();
        },
        videosConverted(response, key) {
            this.videos[key].converted_for_streaming_at = response.converted_for_streaming_at;
            this.videos[key].thumbnail = response.thumbnail;
            this.videos[key].src = response.src;
        },
        openVideo: function(data) {
            this.choseVideo = {
                src: data[0].src,
                index: data[0].index,
                load: true
            }
        },
        closeVideo: function() {
            this.choseVideo.load = false;
        },
        switchOnClass(name){
            this.classes[name] = true
            setTimeout(() => {
                this.classes[name + '_content'] = true
            }, 100)
        },
        switchOffClass(name){
            this.classes[name + '_content'] = false
            setTimeout(() => {
                this.classes[name] = false
            }, 100)
        },
        openChat(id){
            axios
                .get(`/messages/find/chat?receiver_id=${id}`)
                .then(response => {
                    let data = response.data
                    window.location.href = '/messages/chat/' + data.chat_id;
                }).catch(function (error) {
                console.log('error - openChat')
                console.log(error)
            })
        },
        addReport(){
            axios
                .post('/report',{
                    description : this.descReport ,
                    user_id : this.account.id,
                    file : this.$refs.fileReport.files[0],
                })
                .then(response => {
                    let data = response
                }).catch(function (error) {
                console.log('error - addReport')
                console.log(error)
            })
        },
        loadInfoAccount(username) {
            this.loadVideo = false
            if(!this.getUser.id || this.getUser.username != username){
                axios
                    .get(`/webapi/account/${username}`)
                    .then(response => {
                        this.account = response.data.user
                        this.videosCount = response.data.user.videos_count
                        this.loadVideoAccount(this.account.id)
                        this.setLoad(false)
                        this.lastOnline(this.account.last_online_at)
                    })
                    .catch((error) => {
                    this.loadVideo = false
                    console.log(error)
                })
            }else{
                this.account = this.getUser
                this.loadVideoAccount(this.account.id)
                this.videosCount = this.getUser.videos_count
                this.setLoad(false)
                this.lastOnline(this.account.last_online_at)
            }
        },
        loadVideoAccount(id) {
            this.loadVideo = false
            axios
                .get(`/webapi/account/${id}/videos`)
                .then(response => {
                    let data = response.data
                    this.videos = data.videos//.reverse()
                    this.loadVideo = true;
                    this.videos
                        .filter(item => item.converted_for_streaming_at === null)
                        .forEach((video, key) => {
                            //socket place
                        })
                }).catch((error) => {
                console.log(error)
                this.loadVideo = false
            })
        },
        lastOnline(time) {
            let onlineTime = new Date(time),
                nowTime = new Date();

            if ((nowTime - onlineTime) / 1000 < 120) {
                this.lastTimeOnline = 'online';
            } else {
                this.lastTimeOnline = 'был(а) недавно';
            }
            // else if ((nowTime - onlineTime) / 1000 < 300) {
            //     this.lastTimeOnline = 'был(а) недавно';
            // } else if (nowTime.getDate() - onlineTime.getDate() === 0) {
            //     this.lastTimeOnline = `был(а) сегодня в ${onlineTime.getHours()}:${onlineTime.getMinutes()}`;
            // } else if (nowTime.getDate() - onlineTime.getDate() === 1) {
            //     this.lastTimeOnline = `был(а) вчера в ${onlineTime.getHours()}:${onlineTime.getMinutes()}`;
            // }
        },
        scroll(type) {
            let query = () => {
                axios
                    .get(`/webapi/account/${this.account.id}/videos?last_id=${this.videos[this.videos.length - 1].id}`)
                    .then(response => {
                        let data = response.data;
                        this.videos = this.videos.concat(data.videos);
                        this.videoLoading = true;
                        this.$forceUpdate();
                        if (this.videos.length === this.videosCount) {
                            this.allVideoLoad = true;
                        }
                    }).catch((error) => {
                    console.log(error + 'test');
                    this.loadVideo = false;
                });
            };
            if (type === 'scroll') {
                let load = () => {
                    let bottomOfWindow = Math.max(window.pageYOffset, document.documentElement.scrollTop, document.body.scrollTop) + window.innerHeight >= document.documentElement.offsetHeight - 75
                    if (bottomOfWindow && this.videos.length < this.videosCount) {
                        if (this.videoLoading) {
                            query();
                        }
                        this.videoLoading = false;
                    }
                }
                window.ontouch = load
                window.onscroll = load
            } else if (type === 'swipe') {
                query();
            }
        },
        checkIsFollowing(id) {
            axios
                .get(`/webapi/isFollowing/${id}/`)
                .then(response => {
                    let data = response.data
                    this.isFollowing = data
                }).catch((error) => {
                this.getUser = false
            })
        },
        share: async (name, desc, userName) => {
            let link = 'https://friendsonly.me/account/' + userName
            if (!desc) {
                desc = '';
            }
            try {
                await navigator.share(
                    {
                        title: name, // Заголовок
                        text: desc, // Текст
                        url: link, // ссылка
                    }
                )
            } catch (err) {
                console.error("Share failed:", err.message);
            }
        },
        routeToSettings(){
            this.$router.push({name: 'settings'})
            this.$forceUpdate()
        },
    },
    components: {
        AccountVideo,
        AccountSlider
    }
}
export default Account
</script>

<style lang="css">
.item__content-nav ul{
    display: block;
    padding: 0;
}
.item__content-nav ul li {
    width: auto;
    border: 0;
    border-radius: 0;
    background: transparent;
    height: auto;
}
.item__content-nav ul li:before{
    content: none;
}
.page-account{
    padding-bottom: 66px;
}
.page-account.complete{
    padding-bottom: 60px;
}
.page-account .name{
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.page-account .name .online{
    font-family: Gilroy;
    font-style: normal;
    font-weight: 500;
    font-size: 14px;
    line-height: 16px;
    text-align: center;
    color: #707579;
}
.page-account .name .online.active{
    color: #468ADE;
}
.page-account .page-account__avatar .onlineStatus{
    position: absolute;
    bottom: 5px;
    right: 3px;
}
.page-account__videoPreloader.post_load{
    height: 25px;
    background-size: 30px;
}
.page-account .page-account__title-box{
    display: flex;
    justify-content: center;
    padding: 0 40px;
    height: 51px;
    max-height: 51px;
}
</style>
