<template>
    <div class="tabs">
        <div class="tabWrapp first" v-for="(tab, index, count) of tabsData" :key="tab.id">
            <div v-bind:class="['tabBtn', 'first', items.parent[index] ? 'active' : '']" @click="tabShow($event, index, 'main')">
                <svg v-if="count === 0" class="btnIcon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 0C4.48566 0 0 4.48566 0 10C0 15.5143 4.48566 20 10 20C15.5143 20 20 15.5143 20 10C20 4.48566 15.5143 0 10 0ZM9.58332 16.6667C8.89402 16.6667 8.33332 16.106 8.33332 15.4167C8.33332 14.7274 8.89402 14.1667 9.58332 14.1667C10.2726 14.1667 10.8333 14.7274 10.8333 15.4167C10.8333 16.106 10.2726 16.6667 9.58332 16.6667ZM10.8333 11.5837V12.9167C10.8333 13.147 10.647 13.3334 10.4166 13.3334H8.75C8.51969 13.3334 8.33332 13.147 8.33332 12.9167V10.8334C8.33332 9.91457 9.08121 9.16668 10 9.16668C10.9188 9.16668 11.6667 8.41879 11.6667 7.5C11.6667 6.58121 10.9188 5.83332 10 5.83332C9.08121 5.83332 8.33332 6.58121 8.33332 7.5V7.91668C8.33332 8.14699 8.14695 8.33336 7.91664 8.33336H6.25C6.01969 8.33336 5.83332 8.14699 5.83332 7.91668V7.5C5.83332 5.20262 7.70262 3.33332 10 3.33332C12.2974 3.33332 14.1667 5.20266 14.1667 7.5C14.1667 9.49953 12.758 11.1939 10.8333 11.5837Z" fill="#404040"/>
                </svg>
                <svg v-else-if="count === 1" class="btnIcon" width="25" height="22" viewBox="0 0 25 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16.1385 9.81111C17.5231 9.81111 18.7221 9.32769 19.7017 8.37389C20.6813 7.42025 21.1779 6.25342 21.1779 4.9054C21.1779 3.55784 20.6813 2.39085 19.7016 1.43691C18.7218 0.483423 17.523 0 16.1385 0C14.7538 0 13.5551 0.483423 12.5755 1.43706C11.5959 2.3907 11.0991 3.55769 11.0991 4.9054C11.0991 6.25342 11.5959 7.42041 12.5757 8.37405C13.5555 9.32753 14.7542 9.81111 16.1385 9.81111Z" fill="#4892F3" fill-opacity="0.5"/>
                    <path d="M24.9579 15.6593C24.9297 15.2624 24.8725 14.8295 24.7884 14.3723C24.7035 13.9118 24.5941 13.4764 24.4632 13.0784C24.328 12.6671 24.1441 12.2609 23.9168 11.8716C23.6809 11.4676 23.4038 11.1158 23.0929 10.8263C22.7677 10.5235 22.3696 10.28 21.9092 10.1023C21.4505 9.92566 20.942 9.83615 20.3982 9.83615C20.1846 9.83615 19.9781 9.92146 19.5792 10.1743C19.3336 10.3301 19.0465 10.5104 18.7259 10.7098C18.4519 10.8798 18.0806 11.039 17.622 11.1832C17.1745 11.3242 16.7202 11.3957 16.2719 11.3957C15.8235 11.3957 15.3693 11.3242 14.9214 11.1832C14.4633 11.0392 14.092 10.8799 13.8182 10.7099C13.5007 10.5124 13.2134 10.3322 12.9642 10.1741C12.5658 9.92131 12.3591 9.836 12.1455 9.836C11.6015 9.836 11.0932 9.92566 10.6346 10.1025C10.1746 10.2798 9.77633 10.5233 9.45085 10.8265C9.14006 11.1161 8.86279 11.4678 8.62718 11.8716C8.40003 12.2609 8.21614 12.6669 8.08078 13.0786C7.95004 13.4765 7.8407 13.9118 7.75578 14.3723C7.67166 14.8289 7.61451 15.262 7.58626 15.6598C7.55848 16.0495 7.54443 16.454 7.54443 16.8625C7.54443 17.9257 7.89162 18.7864 8.57626 19.4212C9.25244 20.0475 10.1471 20.3653 11.2352 20.3653H21.3095C22.3975 20.3653 23.2919 20.0477 23.9682 19.4212C24.653 18.7869 25.0002 17.926 25.0002 16.8623C25.0001 16.4519 24.9859 16.0472 24.9579 15.6593Z" fill="#4892F3" fill-opacity="0.5"/>
                    <path d="M8.05747 11.3201C9.44207 11.3201 10.641 10.8367 11.6207 9.88293C12.6003 8.92929 13.0969 7.76245 13.0969 6.41443C13.0969 5.06688 12.6003 3.89989 11.6205 2.94594C10.6407 1.99246 9.44191 1.50903 8.05747 1.50903C6.67271 1.50903 5.47408 1.99246 4.49445 2.94609C3.51482 3.89973 3.01807 5.06672 3.01807 6.41443C3.01807 7.76245 3.51482 8.92944 4.49461 9.88308C5.4744 10.8366 6.67319 11.3201 8.05747 11.3201Z" fill="#4892F3"/>
                    <path d="M17.4135 17.1683C17.3852 16.7715 17.3281 16.3385 17.244 15.8814C17.159 15.4208 17.0497 14.9854 16.9188 14.5874C16.7836 14.1761 16.5997 13.7699 16.3724 13.3807C16.1365 12.9766 15.8594 12.6248 15.5484 12.3353C15.2233 12.0325 14.8251 11.789 14.3648 11.6114C13.906 11.4347 13.3976 11.3452 12.8538 11.3452C12.6402 11.3452 12.4336 11.4305 12.0347 11.6833C11.7892 11.8392 11.502 12.0194 11.1815 12.2188C10.9074 12.3888 10.5361 12.5481 10.0775 12.6923C9.63011 12.8332 9.17581 12.9047 8.72742 12.9047C8.27903 12.9047 7.82489 12.8332 7.37698 12.6923C6.91885 12.5482 6.54756 12.389 6.2738 12.219C5.9563 12.0215 5.66897 11.8412 5.4198 11.6832C5.02137 11.4303 4.81465 11.345 4.60107 11.345C4.05707 11.345 3.54882 11.4347 3.09021 11.6115C2.63017 11.7888 2.2319 12.0323 1.90642 12.3355C1.59563 12.6251 1.31836 12.9768 1.08275 13.3807C0.855598 13.7699 0.671708 14.176 0.536345 14.5876C0.405611 14.9855 0.296267 15.4208 0.211345 15.8814C0.127222 16.3379 0.070076 16.771 0.0418222 17.1688C0.0140471 17.5585 0 17.963 0 18.3715C0 19.4347 0.347188 20.2954 1.03183 20.9302C1.708 21.5566 2.60271 21.8744 3.69072 21.8744H13.7651C14.8531 21.8744 15.7475 21.5567 16.4238 20.9302C17.1086 20.2959 17.4558 19.435 17.4558 18.3714C17.4556 17.961 17.4414 17.5562 17.4135 17.1683Z" fill="#4892F3"/>
                </svg>
                <svg v-else-if="count === 2" class="btnIcon" width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0)">
                        <path d="M14.7084 11.0715C15.9288 12.2919 15.9288 14.2706 14.7084 15.4911C13.488 16.7115 11.5093 16.7115 10.2889 15.4911C9.06843 14.2706 9.06843 12.2919 10.2889 11.0715C11.5093 9.85108 13.488 9.85108 14.7084 11.0715Z" fill="#00CB9A"/>
                        <path d="M21.8749 4.68724H19.7157L18.1524 1.56213H6.84608L5.28426 4.68878L3.12813 4.69262C1.40919 4.69569 0.00987809 6.09648 0.00839381 7.81619L0 20.312C0 22.0355 1.40156 23.4378 3.12511 23.4378H21.8749C23.5985 23.4378 25.0001 22.0363 25.0001 20.3127V7.8123C25 6.0888 23.5984 4.68724 21.8749 4.68724ZM12.4996 19.5314C9.05329 19.5314 6.2494 16.7276 6.2494 13.2812C6.2494 9.8349 9.05329 7.03101 12.4996 7.03101C15.9459 7.03101 18.7498 9.8349 18.7498 13.2812C18.7498 16.7276 15.9459 19.5314 12.4996 19.5314Z" fill="#00CB9A"/>
                    </g>
                    <defs>
                        <clipPath id="clip0">
                            <rect width="25" height="25" fill="white"/>
                        </clipPath>
                    </defs>
                </svg>
                <div class="tabHeading">{{ names[count] }}</div>
                <div class="btnState">
                    <svg width="18" height="11" viewBox="0 0 18 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8.50662 6.64729L2.15242 0.273731C1.97788 0.0982347 1.74439 0.00156791 1.49533 0.00134362C1.24613 0.00111921 1.01261 0.0973655 0.837476 0.272547L0.279982 0.830029C0.104572 1.00493 0.00788976 1.23886 0.00766519 1.48824C0.00744061 1.73762 0.103702 1.97144 0.278796 2.1468L7.84401 9.73554C8.01938 9.91159 8.25384 10.0081 8.50318 10.0077C8.75361 10.0086 8.98797 9.9126 9.16379 9.73673L16.7353 2.16868C16.9107 1.99364 17.0074 1.75998 17.0077 1.51047C17.0079 1.26109 16.9116 1.02727 16.7365 0.851769L16.18 0.293421C15.8178 -0.0698992 15.2277 -0.0704307 14.865 0.292237L8.50662 6.64729Z" fill="#4892F3"/>
                    </svg>
                </div>
            </div>
            <transition name="fade">
                <div class="tabContent first" v-show="items.parent[index]">
                    <div class="tabWrapp second" v-for="(item, itemIndex) in tab" :key="item.id">
                        <div class="tabBtn second" @click="tabShow($event, itemIndex, 'second')">{{ item.name }}</div>
                        <transition name="fade">
                            <div class="tabContent second" v-show="items.child[itemIndex]">
                                <router-link :to="{name: 'FAQ_ID', params: {id: link.id, itemName: link.name, itemText: link.text}}" :key="link.id" v-for="link in item.faq">{{link.name}}</router-link>
                            </div>
                        </transition>
                    </div>
                </div>
            </transition>
        </div>
    </div>
</template>

<script>
const Tabs = {
    props: ['tabsData'],
    data: () => ({
        items: {
            parent: {},
            child: {},
        },
        names: ["Общие вопросы", "Для друзей", "Для создателей"]
    }),
    created() {
        for (let key in this.tabsData) {
            this.items.parent[key] = false;
            for (let child in this.tabsData[key]) {
                this.items.child[child] = false;
            }
        }
    },
    methods: {
        tabShow(event, index, type) {
            if (type === 'main') {
                for (let parent in this.items.parent) {
                    if (parent !== index) {
                        this.items.parent[parent] = false;
                    } else {
                        if (this.items.parent[parent] === true) {
                            this.items.parent[parent] = false;
                        } else {
                            this.items.parent[parent] = true;
                        }
                    }
                }
            } else if (type === 'second') {
                for (let child in this.items.child) {
                    if (+child !== index) {
                        this.items.child[child] = false;
                    } else {
                        if (this.items.child[child] === true) {
                            this.items.child[child] = false;
                        } else {
                            this.items.child[child] = true;
                        }
                    }
                }
            }
            this.$forceUpdate();
        },
    },
};
export default Tabs;
</script>

<style scoped>
.tabContent{
    display: flex;
    flex-direction: column;
    transition: .25s;
}
.fade-enter-active, .fade-leave-active {
    transition: opacity .5s;
}
.fade-enter, .fade-leave-to /* .fade-leave-active до версии 2.1.8 */ {
    opacity: 0;
}
</style>
